<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, shrink-to-fit=no">
		<link rel="stylesheet" href="./css/fonts.css">
		<link rel="stylesheet" href="./css/highlight.min.css">
		<link rel="stylesheet" href="./css/bootstrap.min.css">
		<link rel="stylesheet" href="./css/styling.css">
		<link rel="stylesheet" href="./css/footer.css">
		<link rel="stylesheet" href="./css/index.css">
		<link rel="stylesheet" href="plugins/font-awesome-4.7.0/css/font-awesome.min.css">
		<link rel="icon" href="img/olink.png" type="image/x-icon">
		<title class="lang" key="LAB_BLOCK_TITLE">Block</title>
	</head>
	<body class="bg-dark">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<span>
						<img class="header-image" src="./img/olink.png" alt="logo">
						<span class="fontCuriser lang" key="LAB_INDEX_TITLE">Olink Explorer</span>
					</span>
				</a>
				<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-label="collapse navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<form class="form-inline mr-3" method="post" action="javascript:window.clickSearch();" style="width: 80%;">
						<input type="hidden" name="_csrf" value="2J5QVjIM-2HCLxhSGo_ab99-9GK6b8POdjAE">
						<div class="input-group input-group-sm" style="width: 100%;">
							<input class="form-control form-control-sm indexInput" type="text" id="id_search" name="query" placeholder="Search transaction hash, address, token name">
							<div class="input-group-append">
								<button class="btn btn-primary" type="submit" style="border-radius: 0 1rem 1rem 0;">
									<i class="fa fa-search"></i>
								</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</nav>
		<div class="pb-4 pt-3 pt-md-4" style="background-color: #ffffff;">
			<div class="container px-2 px-sm-3">
				<h1 class="h3"><span class="lang" key="LAB_BLOCK_1">Block</span>
					<small class="monospace" style="width: 100%;" id="id_height"></small>
					<br>
					<small class="monospace word-wrap" style="width: 100%;" id="id_hash"></small>
				</h1>
				<hr>
				<ul class="nav nav-tabs mb-3">
					<li class="nav-item">
						<a class="nav-link active lang" key="LAB_TX_DETAIL" data-toggle="tab" href="#tab-details" role="tab">Details</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="tab-details" role="tabpanel">
						<div class="card mb-3 shadow-sm">
							<div class="card-header"><span class="h6 lang" key="LAB_TX_1">Summary</span></div>
							<div class="card-body">
								<div class="row">
									<div class="col-md-6">
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_PREV">Previous Block</div>
											<div class="summary-split-table-content monospace"><a class="word-wrap" href="javascript:window.clickPrev();" id="id_prev"></a><br><span id="id_height_1"></span>
										</div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_INDEX_MINER"> Miner</div>
											<div class="summary-split-table-content monospace"><a id="id_miner" href="javascript:window.clickMiner();"></a>
											</div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_INDEX_TIME">Timestamp</div>
											<div class="summary-split-table-content monospace">
												<span id="id_time"></span>
											</div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_INDEX_TXS">Transactions</div>
											<div class="summary-split-table-content monospace" id="id_txs"></div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_SIZE">Size</div>
											<div class="summary-split-table-content monospace" id="id_size"></div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_DIFF">Difficulty</div>
											<div class="summary-split-table-content monospace">
												<span title="" data-toggle="tooltip">
													<span id="id_diff"></span>
													<sup></sup>
												</span>
											</div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_NONCE">Nonce</div>
											<div class="summary-split-table-content monospace" id="id_nonce"></div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_MERKLE">Merkle Root</div>
											<div class="summary-split-table-content monospace" id="id_merkle"></div>
										</div>
										<div class="row">
											<div class="summary-split-table-label lang" key="LAB_BLOCK_STATE">State Root</div>
											<div class="summary-split-table-content monospace" id="id_state"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="tab-json" role="tabpanel">
						<ul class="nav nav-pills mb-3">
							<li class="nav-item">
								<a class="nav-link active" data-toggle="tab" href="#tab-json-block-summary" role="tab">Block Summary</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" data-toggle="tab" href="#tab-json-tx-ids" role="tab">Transaction IDs</a>
							</li>
						</ul>
						<div class="tab-content">
							<div class="tab-pane active" id="tab-json-block-summary" role="tabpanel">
								<pre><code class="json bg-light"></code></pre>
							</div>
							<div class="tab-pane" id="tab-json-tx-ids" role="tabpanel">
								<pre><code class="json bg-light"></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<footer class="footer border-top border-primary bg-dark pt-3 pb-1 px-3 text-white" style="border-width: 5px !important;">
			<div class="container">
				<div class="row">
					<div class="col-md-4">
						<dl>
							<dd class="lavaFooter lavaDownload"><img src="./img/olink_1.png" alt="Olink Official Website">
								<a href="../index.html" target="_blank" title="Olink Official Website"></a>
							</dd>
						</dl>
					</div>
					<div class="col-md-5 text-md-right" style="padding-top:15px;">
						<dl>
							<dt class="lavaFooter lavaDownload lang" key="LAB_INDEX_LINKS">Related sites</dt>
							<dd class="lavaFooter-list lavaDownload-list">
								<p>
									<a class="pText lang" key="LAB_INDEX_WEB" href="https://open-link.co/" target="_blank" title="">Olink Official Website</a>
								</p>
								<p>
									<a class="pText" id="id_wallet_link" href="" target="_blank" title="">Olink Wallet</a>
								</p>
								<p>
									<a class="pText" id="id_wallet_link" href="https://t.me/OlinkDAOEN" target="_blank" title="">Olink Telegram</a>
								</p>
								<p>
									<a class="pText" id="id_wallet_link" href="https://twitter.com/olinkdao" target="_blank" title="">Olink Twitter</a>
								</p>
							</dd>
						</dl>
					</div>
					<div class="col-md-3 text-md-right" style="padding-top:15px;">
						<dl>
							<dt class="lavaFooter lavaDownload lang" key="LAB_INDEX_LANGUAGE">Language</dt>
							<dd class="lavaFooter-list lavaDownload-list">
								<p class="dataC">
									<a class="pText lang" key="LAB_INDEX_ENGLISH" href="javascript:setLanguage('en')" title="">English</a>
								</p>
								<p class="dataC">
									<a class="pText lang" key="LAB_INDEX_CHINESE" href="javascript:setLanguage('ch')" title="">Chinese</a>
								</p>
							</dd>
						</dl>
					</div>
				</div>
			</div>
		</footer>
		<script src="./js/jquery-3.5.1.min.js"></script>
		<script src="./js/popper.min.js"></script>
		<script src="./js/bootstrap.min.js"></script>
		<script src="./js/highlight.min.js"></script>
		<script src="./js/Base58.js"></script>
		<script src="./js/bignumber.js"></script>
		<script src="./js/lang/ch.js"></script>
		<script src="./js/lang/en.js"></script>
		<script src="./js/core.js"></script>
		<script src="./js/render.js"></script>
		<script>
			$(document).ready(function() {
				$('[data-toggle="tooltip"]').tooltip();
				$('[data-toggle="popover"]').popover({
					html: true,
					container: "body"
				});


			});

			hljs.initHighlightingOnLoad();
		</script>
		<script>
			window.dataLayer = window.dataLayer || [];

			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-XXXX-X');

			var prev = "";
			var miner = ""

			var renderNumber = function(n) {
				var x = new BigNumber(n);
				return x.toString();
			}

			var refresh = function(data) {
				document.getElementById("id_height").innerHTML = "#" + renderNumber(data.result.number);
				//document.getElementById("id_height_1").innerHTML = "(#" + data.result.number + ")";
				document.getElementById("id_hash").innerHTML = data.result.hash.substr(2);
				document.getElementById("id_prev").innerHTML = data.result.parentHash.substr(2);
				//document.getElementById("id_prev").href = "height.html#" + data.result.parentHash;
				prev = data.result.parentHash;
				document.getElementById("id_miner").innerHTML = Base58.fromAddr(data.result.miner);
				miner = data.result.miner;
				document.getElementById("id_time").innerHTML = fullTimestamp(data.result.timestamp);
				document.getElementById("id_txs").innerHTML = data.result.transactions.length;
				document.getElementById("id_size").innerHTML = Number(data.result.size) + " KB";
				document.getElementById("id_diff").innerHTML = renderNumber(data.result.difficulty);
				document.getElementById("id_nonce").innerHTML = data.result.nonce.substr(2);
				document.getElementById("id_merkle").innerHTML = data.result.transactionsRoot.substr(2);
				document.getElementById("id_state").innerHTML = data.result.stateRoot.substr(2);
			}

			window.onload = function() {
				changeLang();

				var ps = window.location.href.split('#')
				if(ps.length <= 1) {
					return;
				}
				// var hash = "0x" + ps[1];
				// proxyBlock(hash, function(data) {
				// 	refresh(data);
				// }, function(err) {

				// });
				var height = ps[1];
				proxyChianBlock(height, function(data) {
					refresh(data);
				}, function(err) {

				});

				proxyVersion(function(data_version) {
					document.getElementById("id_wallet_link").href = "https://owstore.owopenlinkoracle.com/OW_Store." + parseVersion(data_version.result) + ".apk";
				}, function(err_version) {

				});
			}

			window.clickPrev = function() {
				proxyBlock(prev, function(data) {
					refresh(data);
				}, function(err) {

				});
			}

			window.clickMiner = function() {
				window.location.href = "address.html#" + miner;
			}

		</script>
	</body>
</html>
